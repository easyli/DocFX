<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Using DocFx and Companion Tools to generate a Documentation website | DocFX </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Using DocFx and Companion Tools to generate a Documentation website | DocFX ">
    <meta name="generator" content="docfx 2.56.7.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="using-docfx-and-companion-tools-to-generate-a-documentation-website">Using DocFx and Companion Tools to generate a Documentation website</h1>

<p>If you want an easy way to have a website with all your documentation coming from Markdown files and comments coming from code, you can use <a href="https://dotnet.github.io/docfx/">DocFx</a>. The website generated by DocFx also includes fast search capabilities. There are some gaps in the DocFx solution, but we&#39;ve provided companion tools that help you fill those gaps. </p>
<div class="nextstepaction"><p><a href="customize-look-and-feel.html">customize-look-and-feel</a></p>
</div>
<h2 id="quick-start">Quick Start</h2>
<p>To get you started quickly from scratch, a QuickStart folder is provided which can be copied with some common folder, files and settings mentioned in the steps below. Copy the content from the <a href="https://github.com/mtirionMSFT/DocFxQuickStart/tree/master/QuickStart">QuickStart folder</a> folder to your own repository to get started in minutes.</p>
<div class="TIP"><h5>Tip</h5><p><strong>TLDR;</strong></p>
<p>If you want a really quick start using Azure DevOps and Azure App Service without reading the what and how, follow these steps:</p>
<ol>
<li><strong>Azure DevOps:</strong> If you don&#39;t have it yet, create a project in Azure DevOps and <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/library/connect-to-azure?view=azure-devops">create a Service Connection to your Azure environment</a>. Clone the repository.</li>
<li><strong>QuickStart folder:</strong> Copy the contents of the QuickStart folder to the root of your repository, except for the docs folder if you already have one, the .gitignore and the README.md.</li>
<li><strong>Azure:</strong> Create a resource group in your Azure environment where the documentation website resources should be created.</li>
<li><strong>Create Azure resources:</strong> Fill in the default values in <em>infrastructure/variables.tf</em> and run the commands from <a href="deploy-docfx-azure-website.html#3-deploy-azure-resources-from-your-local-machine">Step 3 - Deploy Azure resources from your local machine</a> to create the Azure Resources.</li>
<li><strong>Pipeline:</strong> Fill in the variables in <em>DocFx/.pipelines/documentation.yml</em>, commit the changes and push the contents of the repository to your branch (possibly through a PR).
Now you can create a pipeline in your Azure DevOps project that uses the <em>DocFx/.pipelines/documentation.yml</em> and run it.</li>
</ol>
</div>
<p><img src="../.attachments/SampleDocFxWebsite.png" alt="Sample DocFx Website"></p>
<h2 id="documents-and-projects-folder-structure">Documents and projects folder structure</h2>
<p>If that&#39;s not the case in your situation but you still want to combine multiple repositories into one documentation website, you&#39;ll have to clone all repositories first to be able to combine the information. In this recipe we&#39;ll assume a monorepo is used.</p>
<p>In the steps below we&#39;ll consider the generation of the documentation website from this content structure:</p>
<pre><code class="lang-xaml">├── DocFx               // all documents
│   ├── .pipelines      // Azure DevOps pipeline for automatic generation and deployment
│   ├── infrastructure  // Terraform scripts for creation of the Azure website
│   ├── templates       // Templates for website and PDF generation
│   ├── GenerateDoc.cmd // Command file for local execution for generating website and PDF
│   ├── web.config      // web.config to enable search in deployed website (IIS)
│
├── docs                // all documents
│   ├── .attachments    // all images and other attachments used by documents
│
├── src                 // all projects
│   ├── build           // build settings
│          ├── dotnet   // .NET build settings
│   ├── Directory.Build.props   // project settings for all .NET projects in sub folders
│   ├── [Project folders]
│
├── x-cross
│   ├── toc.yml         // Cross reference definition (optional)
│
├── .markdownlint.json  // Markdownlinter settings
├── docfx.json          // DocFx configuration
├── index.md            // Website landing page
├── README.md           // Description of folders and files here (repo only, not in docs)
├── toc.yml             // Definition of the website header content links
</code></pre><p>We&#39;ll be using the <code>DocLinkChecker</code> tool to validate all links in documentation and for orphaned attachments. That&#39;s the reason we have all attachments in the <code>.attachments</code> folder.</p>
<p>In the generated website from the QuickStart folder you&#39;ll see that the hierarchies of documentation and references is combined in the left table of contents. This is achieved by the definition and use of <strong>x-cross\toc.yml</strong>. If you don&#39;t want the hierarchies combined, just remove the  folder and file from your environment and (re)generate the website.</p>
<p>A <code>.markdownlint.json</code> is included with the contents below. The <a href="https://github.com/markdownlint/markdownlint/blob/master/docs/RULES.md#md013---line-length">MD013 setting</a> is set to false to prevent checking for maximum line length. You can modify this file to your likings to include or exclude certain tests.</p>
<pre><code class="lang-json">{
    &quot;MD013&quot;: false
}
</code></pre><p>The contents of the <strong>DocFx/.pipelines</strong> and <strong>DocFx/infrastructure</strong> folders are explained in the recipe <a href="deploy-docfx-azure-website.html">Deploy the DocFx Documentation website to an Azure Website automatically</a>.</p>
<h2 id="reference-documentation-from-source-code">Reference documentation from source code</h2>
<p>DocFx can generate reference documentation from code, where C# and Typescript are supported best at the moment. In the QuickStart folder we only used C# projects. For DocFx to generate quality reference documentation, quality triple slash-comments are required. See <a href="https://dotnet.github.io/docfx/spec/triple_slash_comments_spec.html">Triple-slash (///) Code Comments Support</a>. To enforce this, it&#39;s a good idea to enforce the use of <a href="https://github.com/DotNetAnalyzers/StyleCopAnalyzers">StyleCop</a>. There are a few steps that will give you an easy start with this.</p>
<p>First, you can use the <strong>Directory.Build.props</strong> file in the <strong>/src</strong> folder in combination with the files in the <strong>build/dotnet</strong> folder. By having this, you enforce StyleCop in all Visual Studio project files in it&#39;s sub folders with a configuration of which rules should be used or ignored. You can tailor this to your needs of course. For more information, see <a href="https://docs.microsoft.com/en-us/visualstudio/msbuild/customize-your-build?view=vs-2019">Customize your build</a> and <a href="https://docs.microsoft.com/en-us/visualstudio/code-quality/using-rule-sets-to-group-code-analysis-rules?view=vs-2019">Use rule sets to group code analysis rules</a>.</p>
<p>To make sure developers are forced to add the triple-slash comments by throwing compiler errors and to have the proper settings for the generation of documentation XML-files, add the <strong>TreatWarningsAsErrors</strong> and <strong>GenerateDocumentationFile</strong> settings to every <em>.csproj</em> file. You can add that in the first <em>PropertyGroup</em> settings like this:</p>
<pre><code class="lang-xml">&lt;Project Sdk=&quot;Microsoft.NET.Sdk&quot;&gt;

  &lt;PropertyGroup&gt;
      ...
    &lt;GenerateDocumentationFile&gt;true&lt;/GenerateDocumentationFile&gt;
    &lt;TreatWarningsAsErrors&gt;true&lt;/TreatWarningsAsErrors&gt;
  &lt;/PropertyGroup&gt;

    ...
&lt;/Project&gt;
</code></pre><p>Now you are all set to generate documentation from your C# code. For more information about languages supported by DocFx and how to configure it, see <a href="https://dotnet.github.io/docfx/tutorial/universalreference/intro_multiple_langs_support.html?q=typescript">Introduction to Multiple Languages Support</a>.</p>
<div class="NOTE"><h5>Note</h5><p>You can also add a PropertyGroup definition with the two settings in <em>Directory.Build.props</em> to have that settings in all projects. But in that case it will also be inherited in your Test projects.</p>
</div>
<h2 id="1-install-docfx-and-markdownlint-cli">1. Install DocFx and markdownlint-cli</h2>
<p>Go to the <a href="https://dotnet.github.io/docfx/">DocFx</a> website to the Download section and download the latest version of DocFx. Go to the <a href="https://github.com/igorshubovych/markdownlint-cli">github page of markdownlint-cli</a> to find download and install options.</p>
<p>You can also use tools like <a href="https://chocolatey.org/">Chocolatey</a> to install:</p>
<pre><code class="lang-bash">choco install docfx
choco install markdownlint-cli
</code></pre><h2 id="2--configure-docfx">2.  Configure DocFx</h2>
<p>Configuration for DocFx is done in a <code>docfx.json</code> file. Store this file in the root of your repository.</p>
<div class="NOTE"><h5>Note</h5><p>You can store the docfx.json somewhere else in the hierarchy, but then you need to provide the path of the file as an argument to the docfx command so it can be located.</p>
</div>
<p>Below is a good configuration to start with, where documentation is in the <strong>/docs</strong> folder and the sources are in the <strong>/src</strong> folder:</p>
<pre><code class="lang-json">{
  &quot;metadata&quot;: [
    {
      &quot;src&quot;: [
        {
          &quot;files&quot;: [&quot;src/**.csproj&quot;],
          &quot;exclude&quot;: [ &quot;output/_site/**&quot;, &quot;output/_pdf/**&quot;, &quot;DocFx/**&quot;, &quot;**/bin/**&quot;, &quot;**/obj/**&quot;, &quot;**/[Tt]ests/**&quot; ]
        }
      ],
      &quot;dest&quot;: &quot;output/reference&quot;,
      &quot;disableGitFeatures&quot;: false
    }
  ],
  &quot;build&quot;: {
    &quot;content&quot;: [
      {
        &quot;files&quot;: [&quot;output/reference/**&quot;]
      },
      {
        &quot;files&quot;: [&quot;**.md&quot;, &quot;**/toc.yml&quot;],
        &quot;exclude&quot;: [ &quot;README.md&quot;, &quot;output/_site/**&quot;, &quot;output/_pdf/**&quot;, &quot;DocFx/**&quot;, &quot;**/bin/**&quot;, &quot;**/obj/**&quot;, &quot;**/[Tt]ests/**&quot; ]
      }
    ],
    &quot;resource&quot;: [
      {
        &quot;files&quot;: [&quot;docs/.attachments/**&quot;]
      },
      {
        &quot;src&quot;: &quot;DocFx&quot;,
        &quot;files&quot;: [&quot;web.config&quot;]
      }
    ],
    &quot;template&quot;: [&quot;DocFx/templates/cse&quot;],
    &quot;globalMetadata&quot;: {
      &quot;_appTitle&quot;: &quot;CSE Documentation&quot;,
      &quot;_enableSearch&quot;: true
    },
    &quot;markdownEngineName&quot;: &quot;markdig&quot;,
    &quot;dest&quot;: &quot;output/_site&quot;,
    &quot;xrefService&quot;: [&quot;https://xref.docs.microsoft.com/query?uid={uid}&quot;]
  },
  &quot;pdf&quot;: {
    &quot;name&quot;: &quot;CSE-Documentation&quot;,
    &quot;coverTitle&quot;: &quot;CSE Documentation&quot;,
    &quot;content&quot;: [
      {
        &quot;files&quot;: [&quot;output/reference/**&quot;]
      },
      {
        &quot;files&quot;: [&quot;**.md&quot;, &quot;x-cross/toc.yml&quot;],
        &quot;exclude&quot;: [ &quot;output/_site/**&quot;, &quot;output/_pdf/**&quot;, &quot;DocFx/**&quot;, &quot;**/bin/**&quot;, &quot;**/obj/**&quot;, &quot;**/[Tt]ests/**&quot; ]
      }
    ],
    &quot;resource&quot;: [
      {
        &quot;files&quot;: [&quot;docs/.attachments/**&quot;]
      }
    ],
    &quot;template&quot;: [&quot;DocFx/templates/pdf.cse&quot;],
    &quot;globalMetadata&quot;: {
      &quot;_appTitle&quot;: &quot;CSE Documentation&quot;
    },
    &quot;wkhtmltopdf&quot;: {
      &quot;additionalArguments&quot;: &quot;--enable-local-file-access&quot;
    },
    &quot;markdownEngineName&quot;: &quot;markdig&quot;,
    &quot;dest&quot;: &quot;output/_pdf&quot;
  }
}
</code></pre><h2 id="3-setup-some-basic-documents">3. Setup some basic documents</h2>
<p>We suggest starting with a basic documentation structure in the <strong>/docs</strong> folder. In the provided QuickStart folder we have a basic setup:</p>
<pre><code class="lang-xaml">├── docs
│   ├── .attachments               // All images and other attachments used by documents
│
│   ├── architecture-decisions
│           └── .order
│           └── decision-log.md    // Sample index into all ADRs
│           └── README.md          // Landing page architecture decisions
│
│   ├── getting-started
│           └── .order
│           └── README.md          // This recipe document. Replace the content with something meaningful to the project
│
│   ├── guidelines
│           └── .order
│           └── docs-guidelines.md // General documentation guidelines
│           └── README.md          // Landing page guidelines
│
│   ├── templates                  // all templates like ADR template and such
│           └── .order
│           └── README.md          // Landing page templates
│
│   ├── working-agreements
│           └── .order
│           └── README.md          // Landing page working agreements
│
│   ├── .order                     // Providing a fixed order of files and directories
│   ├── index.md                   // Landing page documentation
</code></pre><p>You can use templates like working agreements and such from the <a href="https://github.com/microsoft/code-with-engineering-playbook/">CSE Playbook</a>.</p>
<p>To have a proper landing page of your documentation website, you can use a markdown file called INDEX.MD in the root of your repository. Contents can be something like this:</p>
<pre><code class="lang-markdown"># My Documentation

This is the landing page of the My Documentation website. This is the page to introduce everything on the website.

You can add specific links that are important to provide direct access.

&gt; Try not to duplicate the links on the top of the page, unless it really makes sense.

To get started with the setup of this website, read the getting started document.
</code></pre><h2 id="4-compile-the-companion-tools-and-run-them">4. Compile the companion tools and run them</h2>
<div class="NOTE"><h5>Note</h5><p>To explain each step, we&#39;ll be going through the various steps in the next few paragraphs. In the provided sample, a batch-file called <strong>GenerateDocWebsite.cmd</strong> is included. This script will take all the necessary steps to compile the tools, execute the checks, generate the table of contents and execute docfx to generate the website.</p>
</div>
<p>To check for proper markdown formatting the <strong>markdownlint-cli</strong> tool is used. The command takes it&#39;s configuration from the <code>.markdownlint.json</code> file in the root of the project. To check all markdown files, simply execute this command:</p>
<pre><code class="lang-shell">markdownlint **/*.md
</code></pre><p>In the QuickStart folder we&#39;ve also included the two companion tools <strong>TocDocFxCreation</strong> and <strong>DocLinkChecker</strong>.</p>
<div class="NOTE"><h5>Note</h5><p>The QuickStart folder contains a static version of the companion tools. To use the latest version, download it from the <a href="https://github.com/Ellerbach/docfx-companion-tools">DocFx Companion Tools repository</a>.</p>
</div>
<p>You can compile the tools from Visual Studio, but you can also run <code>dotnet build</code> in both tool folders.</p>
<p>The <strong>DocLinkChecker</strong> companion tool is used to validate what&#39;s in the docs folder. It validates links between documents and attachments in the docs folder and checks if there aren&#39;t orphaned attachments. An example of executing this tool, where the check of attachments is included:</p>
<pre><code class="lang-shell">DocLinkChecker.exe -d ./docs -a
</code></pre><p>The <strong>TocDocFxCreation</strong> tool is needed to generate a table of contents for your documentation, so users can navigate between folders and documents. If you have compiled the tool, use this command to generate a table of content file <code>toc.yml</code>. To generate a table of contents with the use of the .order files for determining the sequence of articles and to automatically generate index.md documents if no default document is available in a folder, this command can be used:</p>
<pre><code class="lang-shell">TocDocFxCreation.exe -d ./docs -sri
</code></pre><h2 id="5-run-docfx-to-generate-the-website">5. Run DocFx to generate the website</h2>
<p>Run the <code>docfx</code> command to generate the website, by default in the <strong>_site</strong> folder.</p>
<div class="TIP"><h5>Tip</h5><p>If you want to check the website in your local environment, provide the <strong>--serve</strong> option to either the <em>docfx</em> command or the <em>GenerateDocWebsite</em> script. A small webserver is launched that hosts your website, which is accessible on localhost.</p>
</div>
<h3 id="style-of-the-website">Style of the website</h3>
<p>If you started with the QuickStart folder, the website is generated using a custom theme using <a href="https://ovasquez.github.io/docfx-material/">material design</a> and the Microsoft logo. You can change this to your likings. For more information see <a href="https://dotnet.github.io/docfx/tutorial/howto_create_custom_template.html">How-to: Create A Custom Template | DocFX website (dotnet.github.io)</a>.</p>
<h2 id="deploy-to-an-azure-website">Deploy to an Azure Website</h2>
<p>After you completed the steps, you should have a default website generated in the <em>_site</em> folder. But of course, you want this to be accessible for everyone. So, the next step is to create for instance an Azure Website and have a process to automatically generate and deploy the contents to that website. That process is described in the recipe <a href="deploy-docfx-azure-website.html">Deploy the DocFx Documentation website to an Azure Website automatically</a>.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://dotnet.github.io/docfx/index.html">DocFX - static documentation generator</a></li>
<li><a href="deploy-docfx-azure-website.html">Deploy the DocFx Documentation website to an Azure Website automatically</a></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top"><span style="color:#0d47a1;font-size:16px;">返回顶部</span></a>
            </span>
            <span>Copyright © easyli</span>
            
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
